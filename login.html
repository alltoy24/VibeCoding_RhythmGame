<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>WEB BEAT : AUTH</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap');
        body {
            background-color: #050505;
            color: #00e5ff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: 'Orbitron', sans-serif;
            overflow: hidden;
        }
        .loading-text {
            font-size: 24px;
            margin-bottom: 40px;
            animation: blink 1s infinite;
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
            letter-spacing: 3px;
        }
        @keyframes blink { 50% { opacity: 0.3; } }
        
        /* 구글 버튼 커스텀 (다크모드 강제) */
        .g_id_signin { margin-top: 20px; }
    </style>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <div class="loading-text">ACCESSING NEURAL NETWORK...</div>
    
    <div id="google-login-container"></div>
    <div style="color:#444; margin-top:20px; font-size:12px; font-family:sans-serif;">SECURE CONNECTION REQUIRED</div>

    <script>
        // ★ 님의 클라이언트 ID를 여기에 꼭 넣으세요!
        const GOOGLE_CLIENT_ID = "143854068141-s09m4p44lfju13dv2gdotoe9hbjfvmmr.apps.googleusercontent.com";

        window.onload = function() {
            google.accounts.id.initialize({
                client_id: GOOGLE_CLIENT_ID,
                callback: handleCredentialResponse
            });
            
            // 버튼 렌더링 (검은색 테마로 크게)
            google.accounts.id.renderButton(
                document.getElementById("google-login-container"),
                { theme: "filled_black", size: "large", shape: "pill", width: 280, text: "continue_with" }
            );
        };

        function handleCredentialResponse(response) {
            // 1. 토큰 해독
            const responsePayload = parseJwt(response.credential);
            
            // 2. 브라우저 저장소(localStorage)에 유저 정보 저장
            // ★ 이게 핵심입니다! 여기서 저장해야 index.html이 알아봅니다.
            localStorage.setItem('wb_auth_profile', JSON.stringify(responsePayload));
            
            // 3. 메인 화면(index.html)으로 복귀
            window.location.href = 'index.html'; 
        }

        // JWT 디코딩 함수
        function parseJwt (token) {
            var base64Url = token.split('.')[1];
            var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            return JSON.parse(jsonPayload);
        }
    </script>
</body>
</html>